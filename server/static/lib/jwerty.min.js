/*
 * jwerty - Awesome handling of keyboard events
 *
 * This code is licensed under the MIT
 * For the full license see: http://keithamus.mit-license.org/
 * For more information see: http://keithamus.github.com/jwerty
 *
 * @author Keith Cirkel ('keithamus') <jwerty@keithcirkel.co.uk>
 * @license http://keithamus.mit-license.org/
 * @copyright Copyright Â© 2011, Keith Cirkel
 */
(function(m,t){function j(a,b){return null===a?"null"===b:void 0===a?"undefined"===b:a.is&&a instanceof k?"element"===b:7<Object.prototype.toString.call(a).toLowerCase().indexOf(b)}function o(a){var b,d,f,e,i,c,g,l;if(a instanceof o)return a;j(a,"array")||(a=(""+a).replace(/\s/g,"").toLowerCase().match(/(?:\+,|[^,])+/g));for(b=0,d=a.length;b<d;++b){j(a[b],"array")||(a[b]=(""+a[b]).match(/(?:\+\/|[^\/])+/g));for(c=[],f=a[b].length;f--;){g=a[b][f];i={jwertyCombo:""+g,shiftKey:!1,ctrlKey:!1,altKey:!1,
metaKey:!1};j(g,"array")||(g=(""+g).toLowerCase().match(/(?:(?:[^\+])+|\+\+|^\+$)/g));for(e=g.length;e--;)"++"===g[e]&&(g[e]="+"),g[e]in h.mods?i[u[h.mods[g[e]]]]=!0:g[e]in h.keys?i.keyCode=h.keys[g[e]]:l=g[e].match(/^\[([^-]+\-?[^-]*)-([^-]+\-?[^-]*)\]$/);if(j(i.keyCode,"undefined"))if(l&&l[1]in h.keys&&l[2]in h.keys){l[2]=h.keys[l[2]];l[1]=h.keys[l[1]];for(e=l[1];e<l[2];++e)c.push({altKey:i.altKey,shiftKey:i.shiftKey,metaKey:i.metaKey,ctrlKey:i.ctrlKey,keyCode:e,jwertyCombo:""+g});i.keyCode=e}else i.keyCode=
0;c.push(i)}this[b]=c}this.length=b;return this}var p=m.document,k=m.jQuery||m.Zepto||m.ender||p,q,r;k===p?(q=function(a,b){return a?k.querySelector(a,b||k):k},r=function(a,b){a.addEventListener("keydown",b,!1)},$f=function(a,b){var d=document.createEvent("Event"),f;d.initEvent("keydown",!0,!0);for(f in b)d[f]=b[f];return(a||k).dispatchEvent(d)}):(q=function(a,b){return k(a||p,b)},r=function(a,b){k(a).bind("keydown.jwerty",b)},$f=function(a,b){k(a||p).trigger(k.Event("keydown",b))});var u={16:"shiftKey",
17:"ctrlKey",18:"altKey",91:"metaKey"},h={mods:{"\u21e7":16,shift:16,"\u2303":17,ctrl:17,"\u2325":18,alt:18,option:18,"\u2318":91,meta:91,cmd:91,"super":91,win:91},keys:{"\u232b":8,backspace:8,"\u21e5":9,"\u21c6":9,tab:9,"\u21a9":13,"return":13,enter:13,"\u2305":13,pause:19,"pause-break":19,"\u21ea":20,caps:20,"caps-lock":20,"\u238b":27,escape:27,esc:27,space:32,"\u2196":33,pgup:33,"page-up":33,"\u2198":34,pgdown:34,"page-down":34,"\u21df":35,end:35,"\u21de":36,home:36,ins:45,insert:45,del:46,"delete":46,
"\u2190":37,left:37,"arrow-left":37,"\u2191":38,up:38,"arrow-up":38,"\u2192":39,right:39,"arrow-right":39,"\u2193":40,down:40,"arrow-down":40,"*":106,star:106,asterisk:106,multiply:106,"+":107,plus:107,"-":109,subtract:109,"=":187,equals:187,",":188,comma:188,".":190,period:190,"full-stop":190,"/":191,slash:191,"forward-slash":191,"`":192,tick:192,"back-quote":192,"[":219,"open-bracket":219,"\\":220,"back-slash":220,"]":221,"close-bracket":221,"'":222,quote:222,apostraphe:222}};for(c=95,n=0;106>++c;)h.keys["num-"+
n]=c,++n;for(c=47,n=0;58>++c;)h.keys[n]=c,++n;for(c=111,n=1;136>++c;)h.keys["f"+n]=c,++n;for(var c=64;91>++c;)h.keys[String.fromCharCode(c).toLowerCase()]=c;var s=t.jwerty={event:function(a,b,d){if(j(b,"boolean"))var f=b,b=function(){return f};var a=new o(a),e=0,i=a.length-1,c,g;return function(f){(g=s.is(a,f,e))?e<i?++e:(c=b.call(d||this,f,g),!1===c&&f.preventDefault(),e=0):e=s.is(a,f)?1:0}},is:function(a,b,d){for(var a=new o(a),a=a[d||0],b=b.originalEvent||b,d=a.length,f=!1;d--;){var f=a[d].jwertyCombo,
e;for(e in a[d])"jwertyCombo"!==e&&b[e]!=a[d][e]&&(f=!1);if(!1!==f)break}return f},key:function(a,b,d,f,e){var c=j(d,"element")||j(d,"string")?d:f,h=c===d?m:d,d=c===d?f:e;r(j(c,"element")?c:q(c,d),s.event(a,b,h))},fire:function(a,b,d,c){a=new o(a);c=j(d,"number")?d:c;$f(j(b,"element")?b:q(b,d),a[c||0][0])},KEYS:h}})(this,"undefined"!==typeof module&&module.exports?module.exports:this);
